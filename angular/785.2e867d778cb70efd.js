"use strict";(self.webpackChunkmean=self.webpackChunkmean||[]).push([[785],{7785:(Q,h,a)=>{a.r(h),a.d(h,{PostsModule:()=>Y});var i=a(2382),f=a(9808),p=a(6609),F=a(4786),t=a(4893),T=a(7579),v=a(9646),P=a(8306);const b=e=>{if("string"==typeof e.value)return(0,v.of)(null);const s=e.value,o=new FileReader;return P.y.create(r=>{o.addEventListener("loadend",()=>{const l=new Uint8Array(o.result).subarray(0,4);let u="",m=!1;for(let c=0;c<l.length;c++)u+=l[c].toString(16);switch(u){case"89504e47":case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":m=!0;break;default:m=!1}r.next(m?null:{invalidMimeType:!0}),r.complete()}),o.readAsArrayBuffer(s)})};var C=a(8290),U=a(520),y=a(384),I=a(9224),d=a(7322),Z=a(7531),A=a(7423);function w(e,s){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter title"),t.qZA())}function M(e,s){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter content"),t.qZA())}function S(e,s){if(1&e&&(t.TgZ(0,"div",10),t._UZ(1,"img",11),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("src",o.imagePreview,t.LSH)("alt",o.postForm.value.title)}}let _=(()=>{class e{constructor(o,n,r){this.postService=o,this.httpClient=n,this.authService=r,this.newPost="mean-course",this.post2="",this.postInput1="",this.postInput2="",this.isLoading=!0,this.postsPerPage=2,this.currentPage=1,this.post=[],this.PostInputData=[],this.postsUpdated=new T.x,this.inputData=new t.vpe}ngOnInit(){this.authStatusSub=this.authService.getAuthStatusListener().subscribe(o=>{this.isLoading=!1}),this.postForm=new i.cw({title:new i.NI(null,{validators:[i.kI.required,i.kI.minLength(3)]}),content:new i.NI(null,{validators:[i.kI.required]}),image:new i.NI(null,{validators:[i.kI.required],asyncValidators:[b]})})}onSubmit(){this.postForm.invalid||(this.postService.postData(this.postForm.value.title,this.postForm.value.content,this.postForm.value.image),this.postForm.reset())}onImagePicked(o){const n=o.target.files[0];this.postForm.patchValue({image:n}),this.postForm.get("image").updateValueAndValidity();const r=new FileReader;r.onload=()=>{this.imagePreview=r.result},r.readAsDataURL(n)}ngOnDestroy(){this.authStatusSub.unsubscribe()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(C.L),t.Y36(U.eN),t.Y36(y.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-post-create"]],outputs:{inputData:"inputData"},decls:18,vars:4,consts:[[3,"formGroup","submit"],["type","text","formControlName","title","matInput","","placeholder","Enter title"],[4,"ngIf"],["type","text","formControlName","content","matInput","","placeholder","Enter content"],["id","imageUpload"],["mat-stroked-button","","type","submit",3,"click"],["type","file",3,"change"],["filePicker",""],["class","image-preview",4,"ngIf"],["mat-raised-button","","color","primary","type","submit"],[1,"image-preview"],[3,"src","alt"]],template:function(o,n){if(1&o){const r=t.EpF();t.TgZ(0,"mat-card")(1,"form",0),t.NdJ("submit",function(){return n.onSubmit()}),t.TgZ(2,"mat-form-field"),t._UZ(3,"input",1),t.YNc(4,w,2,0,"mat-error",2),t.qZA(),t.TgZ(5,"mat-form-field"),t._UZ(6,"input",3),t.YNc(7,M,2,0,"mat-error",2),t.qZA(),t.TgZ(8,"div",4)(9,"p"),t._uU(10,"Image Upload"),t.qZA(),t.TgZ(11,"button",5),t.NdJ("click",function(){return t.CHM(r),t.MAs(14).click()}),t._uU(12,"pickfile"),t.qZA(),t.TgZ(13,"input",6,7),t.NdJ("change",function(u){return n.onImagePicked(u)}),t.qZA()(),t.YNc(15,S,2,2,"div",8),t.TgZ(16,"button",9),t._uU(17,"Save post"),t.qZA()()()}2&o&&(t.xp6(1),t.Q6J("formGroup",n.postForm),t.xp6(3),t.Q6J("ngIf",n.postForm.get("title").invalid),t.xp6(3),t.Q6J("ngIf",n.postForm.get("content").invalid),t.xp6(8),t.Q6J("ngIf",""!==n.imagePreview&&n.imagePreview&&n.postForm.get("image").valid))},directives:[I.a8,i._Y,i.JL,i.sg,d.KE,i.Fj,Z.Nt,i.JJ,i.u,f.O5,d.TO,A.lW],styles:["mat-card[_ngcontent-%COMP%]{width:80%;margin:auto}mat-form-field[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%}input[type=file][_ngcontent-%COMP%]{visibility:hidden}#imageUpload[_ngcontent-%COMP%]{padding-right:20px}#imageUpload[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:tomato}"]}),e})();const J=e=>{if("string"==typeof e.value)return(0,v.of)(null);const s=e.value,o=new FileReader;return P.y.create(r=>{o.addEventListener("loadend",()=>{const l=new Uint8Array(o.result).subarray(0,4);let u="",m=!1;for(let c=0;c<l.length;c++)u+=l[c].toString(16);switch(u){case"89504e47":case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":m=!0;break;default:m=!1}r.next(m?null:{invalidMimeType:!0}),r.complete()}),o.readAsArrayBuffer(s)})};function N(e,s){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter title"),t.qZA())}function O(e,s){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter content"),t.qZA())}function k(e,s){if(1&e&&(t.TgZ(0,"div",10),t._UZ(1,"img",11),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("src",o.imagePreview,t.LSH)("alt",o.postForm.value.title)}}let E=(()=>{class e{constructor(o,n){this.postsService=o,this.route=n,this.enteredTitle="",this.enteredContent="",this.mode="create",this.isLoading=!1}ngOnInit(){this.route.paramMap.subscribe(o=>{o.has("postId")?(this.mode="edit",this.postId=o.get("postId"),this.postsService.getPost(this.postId).subscribe(n=>{this.isLoading=!1,this.post={id:n._id,title:n.title,content:n.content,imagePath:"",creator:null},console.log(this.post)})):(this.mode="create",this.postId=null)}),this.postForm=new i.cw({title:new i.NI(null,{validators:[i.kI.required,i.kI.minLength(3)]}),content:new i.NI(null,{validators:[i.kI.required]}),image:new i.NI(null,{validators:[i.kI.required],asyncValidators:[J]})})}onSavePost(){this.postForm.invalid||(this.postsService.updatePost(this.postId,this.postForm.value.title,this.postForm.value.content,this.postForm.value.image),this.postForm.reset())}onImagePicked(o){const n=o.target.files[0];this.postForm.patchValue({image:n}),this.postForm.get("image").updateValueAndValidity();const r=new FileReader;r.onload=()=>{this.imagePreview=r.result},r.readAsDataURL(n)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(C.L),t.Y36(p.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-post-edit"]],decls:20,vars:6,consts:[[3,"formGroup","submit"],["type","text","formControlName","title","matInput","","placeholder","Enter title",3,"ngModel"],[4,"ngIf"],["type","content","formControlName","content","matInput","","placeholder","Enter content",3,"ngModel"],["id","imageUpload"],["mat-stroked-button","","type","submit",3,"click"],["type","file",3,"change"],["filePicker",""],["class","image-preview",4,"ngIf"],["mat-raised-button","","color","primary","type","submit"],[1,"image-preview"],[3,"src","alt"]],template:function(o,n){if(1&o){const r=t.EpF();t.TgZ(0,"mat-card")(1,"form",0),t.NdJ("submit",function(){return n.onSavePost()}),t.TgZ(2,"mat-form-field"),t._UZ(3,"input",1),t.YNc(4,N,2,0,"mat-error",2),t.qZA(),t._UZ(5,"br"),t.TgZ(6,"mat-form-field"),t._UZ(7,"input",3),t.YNc(8,O,2,0,"mat-error",2),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"div",4)(11,"p"),t._uU(12,"Image Upload"),t.qZA(),t.TgZ(13,"button",5),t.NdJ("click",function(){return t.CHM(r),t.MAs(16).click()}),t._uU(14,"pickfile"),t.qZA(),t.TgZ(15,"input",6,7),t.NdJ("change",function(u){return n.onImagePicked(u)}),t.qZA()(),t.YNc(17,k,2,2,"div",8),t.TgZ(18,"button",9),t._uU(19,"Save post"),t.qZA()()()}2&o&&(t.xp6(1),t.Q6J("formGroup",n.postForm),t.xp6(2),t.Q6J("ngModel",n.post.title),t.xp6(1),t.Q6J("ngIf",n.postForm.get("title").invalid),t.xp6(3),t.Q6J("ngModel",n.post.content),t.xp6(1),t.Q6J("ngIf",n.postForm.get("content").invalid),t.xp6(9),t.Q6J("ngIf",""!==n.imagePreview&&n.imagePreview))},directives:[I.a8,i._Y,i.JL,i.sg,d.KE,i.Fj,Z.Nt,i.JJ,i.u,f.O5,d.TO,A.lW],styles:["input[type=file][_ngcontent-%COMP%]{visibility:hidden}#imageUpload[_ngcontent-%COMP%]{padding-right:20px}#imageUpload[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:tomato}"]}),e})(),g=(()=>{class e{constructor(o,n){this.authService=o,this.router=n}canActivate(o,n){const r=this.authService.getIsAuth();return r||this.router.navigate(["/login"]),r}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(y.e),t.LFG(p.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();const L=[{path:"create",component:_,canActivate:[g]},{path:"edit/:postId",component:E,canActivate:[g]}];let x=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[g],imports:[[p.Bz.forChild(L)],p.Bz]}),e})(),Y=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[f.ez,i.u5,i.UX,F.h,p.Bz,x]]}),e})()}}]);